name: ⚒️ Automated GHCR Image 

on: 
  push:
    branches:
      - "**"

jobs:
  test-images:
    runs-on: ubuntu-latest
    services:
        docker:
          image: docker:20.10.16-dind
          options: >-
            --privileged 
            --mount type=tmpfs,destination=/var/lib/docker,tmpfs-size=4096m
          ports:
            - 2375:2375
    steps:
    # Checkout your code
    - name: Checkout code
      uses: actions/checkout@v4

    # Pull a Docker image from GitHub Container Registry (GHCR)
    - name: Pull image from GHCR
      run: |
        docker pull ghcr.io/offensive-vk/offensive-vk:nightly

    # Pull a Docker image from Docker Hub
    - name: Pull image from Docker Hub
      run: |
        docker pull ghcr.io/offensive-vk/offensive-vk:master

    # Run a container using the GHCR image
    - name: Run from GHCR image
      run: |
        docker run -it -d --name my-container offensive-vk/offensive-vk:nightly

    # Run a container using the Docker Hub image
    - name: Run container from Docker Hub image
      run: |
        docker run -it -d --name dev-container -p 8080:8080 ntsystems/ntsystems:master

    # List running containers
    - name: List running Docker containers
      run: |
        docker ps -a

    # Optionally perform actions
    - name: Execute command in containers
      run: |
        docker exec my-container uname -a
        docker exec dev-container uname -a
